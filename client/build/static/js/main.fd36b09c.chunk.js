(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{52:function(e,t,n){e.exports=n(65)},65:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),o=n.n(c),u=n(69),l=n(13),s=n(5),i=n.n(s),m=n(6),p=n(18),f=r.a.createContext(),E=n(20),h=n(68),d=n(44),b=n(72),g=function(e){return function(t){var n=Object(a.useContext)(f);return r.a.createElement(e,Object.assign({companyDBService:n},t))}},v=n(16),y=function(e){var t=Object(a.useMemo)((function(){return{data:null,isLoading:!0,error:null}}),[]),n=Object(a.useState)(t),r=Object(v.a)(n,2),c=r[0],o=r[1];return Object(a.useEffect)((function(){o(t);var n=!1;return e().then((function(e){return!n&&function(e){return o({data:e,isLoading:!1,error:null})}(e)})).catch((function(e){return!n&&function(e){return o({data:null,isLoading:!1,error:e})}(e)})),function(){return n=!0}}),[e,t]),c},k=function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Ooops! Something going wrong..."))},w=n(67),O=function(){return r.a.createElement("div",{className:"d-flex my-3"},r.a.createElement(w.a,{className:"mx-auto",animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))},j=function(e){var t=e.employee,n=(e.onSelectItem,t.surname),a=t.name,c=t.patronymic;return r.a.createElement("span",null,n," ",a," ",c)},S=Object(l.g)(g((function(e){var t=e.onClickItem,n=e.companyDBService,c=function(){var e=localStorage.getItem("token"),t=Object(a.useCallback)((function(){return n.getEmployeeList(e)}),[e]);return y(t)}(),o=c.data,u=c.isLoading,l=c.error;return u&&!l?r.a.createElement(O,null):l?l.message:r.a.createElement(b.a,null,o.map((function(e){return r.a.createElement(b.a.Item,{key:e.id,onClick:function(){return t(e.id)}},r.a.createElement(j,{employee:e}))})))}))),x=g((function(e){var t=e.employeeId,n=e.companyDBService,c=function(){var e=localStorage.getItem("token"),r=Object(a.useCallback)((function(){return n.getEmployee(e,t)}),[t,e]);return y(r)}(),o=c.data,u=c.isLoading,l=c.error;if(console.log(o),u&&!l)return r.a.createElement(O,null);if(l)return l.message;var s=o.surname,i=o.name,m=o.patronymic,p=o.birth_date,f=o.birth_place,E=o.department,h=o.position,d=o.passport_series,b=o.passport_ID,g=o.address,v=o.salary,k=o.attitude_to_conscription,w=o.marital_status,j=o.sex;return"m"===j?(j="\u041c\u0443\u0436\u0441\u043a\u043e\u0439",w="y"===w?"\u0416\u0435\u043d\u0430\u0442":"\u041d\u0435 \u0436\u0435\u043d\u0430\u0442"):"f"===j&&(j="\u0416\u0435\u043d\u0441\u043a\u0438\u0439",w="y"===w?"\u0417\u0430\u043c\u0443\u0436\u0435\u043c":"\u041d\u0435 \u0437\u0430\u043c\u0443\u0436\u0435\u043c"),k="neg"===k?"\u041d\u0435\u0433\u0430\u0442\u0438\u0432\u043d\u043e\u0435":"pos"===k?"\u041f\u043e\u0437\u0438\u0442\u0438\u0432\u043d\u043e\u0435":"\u041d\u0435\u0439\u0442\u0440\u0430\u043b\u044c\u043d\u043e\u0435",r.a.createElement("div",null,r.a.createElement("h3",null,s," ",i," ",m),r.a.createElement("p",null,"\u0420\u043e\u0434\u0438\u043b\u0441\u044f \u0432 ",p,", ",f),r.a.createElement("p",null,"\u041e\u0442\u0434\u0435\u043b: ",E),r.a.createElement("p",null,"\u0414\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u044c: ",h),r.a.createElement("p",null,"\u041e\u043a\u043b\u0430\u0434: ",v," \u0440\u0443\u0431."),r.a.createElement("p",null,"\u041f\u043e\u043b: ",j),r.a.createElement("p",null,"\u041f\u0430\u0441\u043f\u043e\u0440\u0442: ",d," ",b),r.a.createElement("p",null,"\u041f\u0440\u043e\u0436\u0438\u0432\u0430\u0435\u0442: ",g),r.a.createElement("p",null,"\u0421\u0435\u043c\u0435\u0439\u043d\u043e\u0435 \u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435: ",w),r.a.createElement("p",null,"\u041e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0435 \u043a \u0432\u043e\u0438\u043d\u0441\u043a\u043e\u0439 \u043e\u0431\u044f\u0437\u0430\u043d\u043d\u043e\u0441\u0442\u0438: ",k))})),C=n(12),T=Object(C.b)((function(e){return Object(E.a)({},e.user)}))(Object(l.g)((function(e){var t=e.history,n=e.match,a=e.user,c=n.params.id;return a?r.a.createElement(h.a,{className:"m-4"},r.a.createElement(d.a,{sm:3},r.a.createElement(S,{onClickItem:function(e){t.push("".concat(e))}})),r.a.createElement(d.a,{sm:9},r.a.createElement("div",{className:"border rounded p-5 w-100"},c?r.a.createElement(x,{employeeId:c}):r.a.createElement("h3",null,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a\u0430 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430")))):r.a.createElement(l.a,{to:"/"})}))),_=n(70),L=n(73),U=g(Object(C.b)((function(e){return Object(E.a)({},e.user)}),(function(e,t){var n=t.companyDBService;return{userLogout:function(){var t=Object(m.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.destroyToken(localStorage.getItem("token")),e({type:"USER_LOGOUT"}),localStorage.removeItem("token");case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}))((function(e){var t=e.user,n=e.userLogout;return r.a.createElement(_.a,{bg:"light",sticky:"top"},r.a.createElement(_.a.Brand,{href:"/"},r.a.createElement("h1",null,"Company DB")),t?r.a.createElement(_.a.Collapse,{className:"justify-content-end"},r.a.createElement(_.a.Text,null,"Signed in as: ",t.username),r.a.createElement(L.a,{variant:"outline-danger",onClick:n},"\u0412\u044b\u0445\u043e\u0434")):"",console.log(t))}))),I=n(71),R=g(Object(C.b)((function(e){return Object(E.a)({},e.user)}),(function(e,t){var n=t.companyDBService;return{fetchUser:function(t){return e(function(e){return function(t){return function(n){console.log(t),n({type:"FETCH_USER_REQUEST"}),e.getMe(t).then((function(e){return n(function(e){return{type:"FETCH_USER_SUCCESS",payload:e}}(e))})).catch((function(e){return n({type:"FETCH_USER_FAILURE",payload:e})}))}}}(n)(t))}}}))((function(e){var t=e.user,n=e.error,c=e.isLoading,o=e.fetchUser,u=Object(a.useState)(""),s=Object(v.a)(u,2),i=s[0],m=s[1],p=Object(a.useState)(""),E=Object(v.a)(p,2),h=E[0],d=E[1],b=Object(a.useState)(""),g=Object(v.a)(b,2),y=g[0],k=g[1],w=Object(a.useState)(!1),j=Object(v.a)(w,2),S=j[0],x=j[1],C=Object(a.useContext)(f);Object(a.useEffect)((function(){var e=localStorage.getItem("token");e&&o(e)}),[]);return c?r.a.createElement(O,null):r.a.createElement(I.a,{className:"w-50 mx-auto"},y?r.a.createElement(I.a.Text,{className:"text-danger"},y):"",n?r.a.createElement(I.a.Text,{className:"text-danger"},n.message,localStorage.removeItem("token")):"",t?r.a.createElement(l.a,{to:"/employee/"}):"",r.a.createElement(I.a.Group,{controlId:"formUsername"},r.a.createElement(I.a.Label,null,"Username"),r.a.createElement(I.a.Control,{placeholder:"Username",value:i,onChange:function(e){return m(e.target.value)}})),r.a.createElement(I.a.Group,{controlId:"formPassword"},r.a.createElement(I.a.Label,null,"Password"),r.a.createElement(I.a.Control,{type:"password",placeholder:"Password",value:h,onChange:function(e){return d(e.target.value)}})),S?r.a.createElement(O,null):r.a.createElement(L.a,{variant:"primary",type:"submit",onClick:function(e){e.preventDefault(),x(!0),C.getToken(i,h).then((function(e){k(!1),localStorage.setItem("token",e.auth_token),console.log(o),o(e.auth_token)})).catch((function(e){k(e.message),x(!1)}))}},"Submit"))}))),N=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(U,null),r.a.createElement(u.a,null,r.a.createElement(l.d,null,r.a.createElement(l.b,{exact:!0,path:"/employee/:id?"},r.a.createElement(T,null)),r.a.createElement(l.b,{exact:!0,path:"/"},r.a.createElement(R,null)),r.a.createElement(l.b,null,r.a.createElement("h2",{className:"m-5 text-center"},"Page not found")))))},D=n(19),F=function(e,t){if(void 0===e)return{user:null,error:null,isLoading:!1};switch(t.type){case"FETCH_USER_REQUEST":return{user:null,error:null,isLoading:!0};case"FETCH_USER_SUCCESS":return{user:t.payload,error:null,isLoading:!1};case"FETCH_USER_FAILURE":return{user:null,error:t.payload,isLoading:!1};case"USER_LOGOUT":return{user:null,error:null,isLoading:!1};default:return e.user}},B=n(46),A=Object(D.c)((function(e,t){return{user:F(e,t)}}),Object(D.a)(B.a)),P=n(15),H=n(47),z=n(50),G=n(49),M=n(51),J=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(z.a)(this,(e=Object(G.a)(t)).call.apply(e,[this].concat(r)))).state={hasError:!1},n}return Object(M.a)(t,e),Object(H.a)(t,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return!0===this.state.hasError?r.a.createElement(k,null):this.props.children}}]),t}(a.Component),Q=new function e(){Object(p.a)(this,e),this.getToken=function(){var e=Object(m.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:8000/auth/token/login/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"username=".concat(t,"&password=").concat(n)});case 2:if(!(a=e.sent).ok){e.next=7;break}return e.abrupt("return",a.json());case 7:if(400!==a.status){e.next=11;break}throw new Error("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0435 \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435");case 11:throw new Error("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a... ".concat(a.status));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.destroyToken=function(){var e=Object(m.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:8000/auth/token/logout/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Token ".concat(t)}});case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a... ".concat(n.status));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getMe=function(){var e=Object(m.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:8000/auth/users/me/",{headers:{Authorization:"Token ".concat(t)}});case 2:if(!(n=e.sent).ok){e.next=7;break}return e.abrupt("return",n.json());case 7:if(401!==n.status){e.next=11;break}throw new Error("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d");case 11:throw new Error("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a... ".concat(n.status));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getEmployeeList=function(){var e=Object(m.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:8000/api/1.0/employee/",{headers:{Authorization:"Token ".concat(t)}});case 2:if(!(n=e.sent).ok){e.next=7;break}return e.abrupt("return",n.json());case 7:if(401!==n.status){e.next=11;break}throw new Error("\u0423 \u0432\u0430\u0441 \u043d\u0435\u0442 \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u044d\u0442\u043e\u0433\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e");case 11:throw new Error("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a... ".concat(n.status));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getEmployee=function(){var e=Object(m.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:8000/api/1.0/employee/".concat(n,"/"),{headers:{Authorization:"Token ".concat(t)}});case 2:if(!(a=e.sent).ok){e.next=7;break}return e.abrupt("return",a.json());case 7:if(401!==a.status){e.next=11;break}throw new Error("\u0423 \u0432\u0430\u0441 \u043d\u0435\u0442 \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u044d\u0442\u043e\u0433\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e");case 11:throw new Error("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a... ".concat(a.status));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};o.a.render(r.a.createElement(C.a,{store:A},r.a.createElement(J,null,r.a.createElement(P.a,null,r.a.createElement(f.Provider,{value:Q},r.a.createElement(N,null))))),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.fd36b09c.chunk.js.map